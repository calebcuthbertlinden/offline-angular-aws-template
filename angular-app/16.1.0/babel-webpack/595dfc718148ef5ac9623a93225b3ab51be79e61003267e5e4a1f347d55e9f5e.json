{"ast":null,"code":"/**\n * For the ORM capabilities,\n * we have to merge the document prototype\n * with the ORM functions and the data\n * We do this iterating over the properties and\n * adding them to a new object.\n * In the future we should do this by chaining the __proto__ objects\n */\n\nimport { createRxDocumentConstructor, basePrototype, createWithConstructor as createRxDocumentWithConstructor } from './rx-document';\nimport { runPluginHooks } from './hooks';\nimport { overwritable } from './overwritable';\nimport { getFromMapOrCreate } from './plugins/utils';\nvar constructorForCollection = new WeakMap();\nexport function getDocumentPrototype(rxCollection) {\n  var schemaProto = rxCollection.schema.getDocumentPrototype();\n  var ormProto = getDocumentOrmPrototype(rxCollection);\n  var baseProto = basePrototype;\n  var proto = {};\n  [schemaProto, ormProto, baseProto].forEach(obj => {\n    var props = Object.getOwnPropertyNames(obj);\n    props.forEach(key => {\n      var desc = Object.getOwnPropertyDescriptor(obj, key);\n\n      /**\n       * When enumerable is true, it will show on console.dir(instance)\n       * To not pollute the output, only getters and methods are enumerable\n       */\n      var enumerable = true;\n      if (key.startsWith('_') || key.endsWith('_') || key.startsWith('$') || key.endsWith('$')) enumerable = false;\n      if (typeof desc.value === 'function') {\n        // when getting a function, we automatically do a .bind(this)\n        Object.defineProperty(proto, key, {\n          get() {\n            return desc.value.bind(this);\n          },\n          enumerable,\n          configurable: false\n        });\n      } else {\n        desc.enumerable = enumerable;\n        desc.configurable = false;\n        if (desc.writable) desc.writable = false;\n        Object.defineProperty(proto, key, desc);\n      }\n    });\n  });\n  return proto;\n}\nexport function getRxDocumentConstructor(rxCollection) {\n  return getFromMapOrCreate(constructorForCollection, rxCollection, () => createRxDocumentConstructor(getDocumentPrototype(rxCollection)));\n}\n\n/**\n * Create a RxDocument-instance from the jsonData\n * and the prototype merge.\n * You should never call this method directly,\n * instead you should get the document from collection._docCache.getCachedRxDocument().\n */\nexport function createNewRxDocument(rxCollection, docData) {\n  var doc = createRxDocumentWithConstructor(getRxDocumentConstructor(rxCollection), rxCollection, overwritable.deepFreezeWhenDevMode(docData));\n  rxCollection._runHooksSync('post', 'create', docData, doc);\n  runPluginHooks('postCreateRxDocument', doc);\n  return doc;\n}\n\n/**\n * returns the prototype-object\n * that contains the orm-methods,\n * used in the proto-merge\n */\nexport function getDocumentOrmPrototype(rxCollection) {\n  var proto = {};\n  Object.entries(rxCollection.methods).forEach(([k, v]) => {\n    proto[k] = v;\n  });\n  return proto;\n}","map":{"version":3,"names":["createRxDocumentConstructor","basePrototype","createWithConstructor","createRxDocumentWithConstructor","runPluginHooks","overwritable","getFromMapOrCreate","constructorForCollection","WeakMap","getDocumentPrototype","rxCollection","schemaProto","schema","ormProto","getDocumentOrmPrototype","baseProto","proto","forEach","obj","props","Object","getOwnPropertyNames","key","desc","getOwnPropertyDescriptor","enumerable","startsWith","endsWith","value","defineProperty","get","bind","configurable","writable","getRxDocumentConstructor","createNewRxDocument","docData","doc","deepFreezeWhenDevMode","_runHooksSync","entries","methods","k","v"],"sources":["/Users/caleblinden/Documents/GitHub/mmf-poc/mmf-poc/node_modules/rxdb/dist/es/rx-document-prototype-merge.js"],"sourcesContent":["/**\n * For the ORM capabilities,\n * we have to merge the document prototype\n * with the ORM functions and the data\n * We do this iterating over the properties and\n * adding them to a new object.\n * In the future we should do this by chaining the __proto__ objects\n */\n\nimport { createRxDocumentConstructor, basePrototype, createWithConstructor as createRxDocumentWithConstructor } from './rx-document';\nimport { runPluginHooks } from './hooks';\nimport { overwritable } from './overwritable';\nimport { getFromMapOrCreate } from './plugins/utils';\nvar constructorForCollection = new WeakMap();\nexport function getDocumentPrototype(rxCollection) {\n  var schemaProto = rxCollection.schema.getDocumentPrototype();\n  var ormProto = getDocumentOrmPrototype(rxCollection);\n  var baseProto = basePrototype;\n  var proto = {};\n  [schemaProto, ormProto, baseProto].forEach(obj => {\n    var props = Object.getOwnPropertyNames(obj);\n    props.forEach(key => {\n      var desc = Object.getOwnPropertyDescriptor(obj, key);\n\n      /**\n       * When enumerable is true, it will show on console.dir(instance)\n       * To not pollute the output, only getters and methods are enumerable\n       */\n      var enumerable = true;\n      if (key.startsWith('_') || key.endsWith('_') || key.startsWith('$') || key.endsWith('$')) enumerable = false;\n      if (typeof desc.value === 'function') {\n        // when getting a function, we automatically do a .bind(this)\n        Object.defineProperty(proto, key, {\n          get() {\n            return desc.value.bind(this);\n          },\n          enumerable,\n          configurable: false\n        });\n      } else {\n        desc.enumerable = enumerable;\n        desc.configurable = false;\n        if (desc.writable) desc.writable = false;\n        Object.defineProperty(proto, key, desc);\n      }\n    });\n  });\n  return proto;\n}\nexport function getRxDocumentConstructor(rxCollection) {\n  return getFromMapOrCreate(constructorForCollection, rxCollection, () => createRxDocumentConstructor(getDocumentPrototype(rxCollection)));\n}\n\n/**\n * Create a RxDocument-instance from the jsonData\n * and the prototype merge.\n * You should never call this method directly,\n * instead you should get the document from collection._docCache.getCachedRxDocument().\n */\nexport function createNewRxDocument(rxCollection, docData) {\n  var doc = createRxDocumentWithConstructor(getRxDocumentConstructor(rxCollection), rxCollection, overwritable.deepFreezeWhenDevMode(docData));\n  rxCollection._runHooksSync('post', 'create', docData, doc);\n  runPluginHooks('postCreateRxDocument', doc);\n  return doc;\n}\n\n/**\n * returns the prototype-object\n * that contains the orm-methods,\n * used in the proto-merge\n */\nexport function getDocumentOrmPrototype(rxCollection) {\n  var proto = {};\n  Object.entries(rxCollection.methods).forEach(([k, v]) => {\n    proto[k] = v;\n  });\n  return proto;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}